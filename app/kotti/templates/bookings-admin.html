{% block content %}
<h4 class="title">Hallinnoitavat varaukset</h4>
<div class="tile is-parent" id="bookings-admin-list">
    <table class="table" id="bookings-admin-table">
    </table>
</div>
<script>

function bookings_admin_refresh() {
    if($('#bookings-old').is(':checked')) {
        var old = '&old=1';
    } else {
        var old = '';
    }

    if($('#bookings-current').is(':checked')) {
        var current = '&current=1';
    } else {
        var current = '';
    }

    if($('#bookings-future').is(':checked')) {
        var future = '&future=1';
    } else {
        var future = '';
    }

    $.get('/api/rooms/?admin=' + user_id + old + current + future, function(data) {
        $('#bookings-admin-table').html('');
        $.each(data, function(i, item) {
            var room_html = '<tr><th class='is-primary'>Huone</th><td class='is-primary' colspan=4>' + item.name + '</td></tr>';
            for(var i=0; i < item.bookings.length; i++) {
                var booking = item.bookings[i];
                room_html += '<tr>';
                room_html += '<td>' + booking.start_time + '</td>';
                room_html += '<td>' + booking.end_time + '</td>';
                room_html += '<td>' + booking.approved + '</td>';
                room_html += '<td>' + booking.persons + '</td>';
                room_html += '<td>' + booking.user.first_name + ' ' + booking.user.last_name + '</td>';
                room_html += '</tr>';
            }
            $('#bookings-admin-table').append(room_html);
        });
    });
}

bookings_admin_refresh();

$("#bookings-old").change(function() {
    bookings_admin_refresh();
});

$("#bookings-current").change(function() {
    bookings_admin_refresh();
});

$("#bookings-future").change(function() {
    bookings_admin_refresh();
});

</script>
{% endblock %}